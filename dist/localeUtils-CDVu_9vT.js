"use strict";var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);const i=require("./cookies-Dw9bISRk.js");class s{static extractLocaleFromPath(t,e=["en","es","fr","de","it","pt"]){const i=t.replace(/^\/+/,"").split("/"),s=i[0];if(s&&e.includes(s)){return{locale:s,pathWithoutLocale:"/"+i.slice(1).join("/")}}return{locale:null,pathWithoutLocale:t}}static addLocaleToPath(t,e){const{pathWithoutLocale:i}=this.extractLocaleFromPath(t),s=i.replace(/^\/+/,"");return`/${e}${s?"/"+s:""}`}static removeLocaleFromPath(t,e=["en","es","fr","de","it","pt"]){const{pathWithoutLocale:i}=this.extractLocaleFromPath(t,e);return i||"/"}static hasLocaleInPath(t,e=["en","es","fr","de","it","pt"]){const{locale:i}=this.extractLocaleFromPath(t,e);return null!==i}static generateLocalizedPaths(t,e=["en","es","fr","de","it","pt"]){const{pathWithoutLocale:i}=this.extractLocaleFromPath(t,e),s={};return e.forEach(t=>{s[t]=this.addLocaleToPath(i,t)}),s}}class o{static getServerLocale(t,e=["en","es","fr","de","it","pt"]){var i,o;if(!t)return"en";const r=t.pathname||t.url;if(r){const{locale:t}=s.extractLocaleFromPath(r,e);if(t)return t}const a=null==(i=t.cookies)?void 0:i["rustle-locale"];if(a&&e.includes(a))return a;const n=null==(o=t.headers)?void 0:o["accept-language"];if(n){const t=n.split(",").map(t=>{var e,i,s,o;return null==(o=null==(s=null==(i=null==(e=null==t?void 0:t.split(";"))?void 0:e[0])?void 0:i.trim())?void 0:s.split("-"))?void 0:o[0]}).filter(t=>t&&e.includes(t));if(t.length>0)return t[0]}return"en"}static setServerLocale(t,e){if(!e)return;const i=`rustle-locale=${t}; Path=/; Max-Age=31536000; SameSite=Lax`;e.setHeader?e.setHeader("Set-Cookie",i):e.headers&&(e.headers["Set-Cookie"]=i)}}class r{static configurePathBasedRouting(t,e){this.pathBasedRouting=t,e&&(this.supportedLocales=e)}static getCurrentLocale(){if("undefined"!=typeof window&&this.pathBasedRouting){const{locale:t}=s.extractLocaleFromPath(window.location.pathname,this.supportedLocales);if(t)return this.currentLocale=t,t}if("undefined"!=typeof window){const t=i.getLocaleFromCookie();t&&(this.currentLocale=t)}return this.currentLocale}static setCurrentLocale(t,e=!0){if(this.currentLocale=t,"undefined"!=typeof window&&(i.setLocaleToCookie(t),this.pathBasedRouting&&e)){const e=s.addLocaleToPath(window.location.pathname,t)+window.location.search+window.location.hash;window.history.pushState(null,"",e)}this.listeners.forEach(e=>e(t))}static navigateToLocalizedPath(t,e){if("undefined"==typeof window)return;const i=e||this.currentLocale;if(this.pathBasedRouting){const e=s.addLocaleToPath(t,i);window.location.href=e}else this.setCurrentLocale(i,!1),window.location.href=t}static subscribe(t){return this.listeners.push(t),()=>{const e=this.listeners.indexOf(t);e>-1&&this.listeners.splice(e,1)}}static initializeFromServer(t){this.currentLocale=t}}e(r,"currentLocale","en"),e(r,"listeners",[]),e(r,"pathBasedRouting",!1),e(r,"supportedLocales",["en","es","fr","de","it","pt"]);class a{static configure(t){this.config={...this.config,...t},r.configurePathBasedRouting(this.config.enabled,this.config.supportedLocales)}static shouldExcludePath(t){var e;return(null==(e=this.config.excludePaths)?void 0:e.some(e=>t.startsWith(e)))||!1}static getLocaleFromRequest(t){const{pathname:e}=t;if(this.shouldExcludePath(e))return{locale:this.config.defaultLocale,shouldRedirect:!1};const{locale:i,pathWithoutLocale:r}=s.extractLocaleFromPath(e,this.config.supportedLocales);if(i)return{locale:i,shouldRedirect:!1};const a=o.getServerLocale({...t,pathname:void 0},this.config.supportedLocales);if(a===this.config.defaultLocale&&!this.config.includeDefaultLocaleInPath)return{locale:a,shouldRedirect:!1};if(this.config.redirectToDefaultLocale){return{locale:a,shouldRedirect:!0,redirectPath:s.addLocaleToPath(e,a)}}return{locale:a,shouldRedirect:!1}}static generateAlternateLinks(t,e=""){const{pathWithoutLocale:i}=s.extractLocaleFromPath(t,this.config.supportedLocales);return this.config.supportedLocales.map(t=>{let o;return o=t!==this.config.defaultLocale||this.config.includeDefaultLocaleInPath?s.addLocaleToPath(i,t):i,{locale:t,href:e+o,hreflang:t===this.config.defaultLocale?"x-default":t}})}static getConfig(){return{...this.config}}}e(a,"config",{enabled:!1,supportedLocales:["en","es","fr","de","it","pt"],defaultLocale:"en",excludePaths:["/api","/static","/_next","/favicon.ico"],includeDefaultLocaleInPath:!1,redirectToDefaultLocale:!0});class n{static setBasePath(t){this.basePath=t.endsWith("/")?t.slice(0,-1):t}static getBasePath(){return this.basePath}static getLocalePath(t){return`${this.basePath}/${t}.json`}static getMasterPath(){return`${this.basePath}/master.json`}}e(n,"basePath","/rustle/locales"),exports.AdvancedPathLocaleManager=a,exports.MetadataPathManager=n,exports.PathLocaleManager=s,exports.ServerLocaleManager=o,exports.UniversalLocaleManager=r,exports.commonPatterns=[{regex:/\b\d+\b/g,placeholder:"{count}"},{regex:/\b\d+\.\d+\b/g,placeholder:"{amount}"},{regex:/\b[A-Z][a-z]+ \d{1,2}, \d{4}\b/g,placeholder:"{date}"},{regex:/\b\d{1,2}:\d{2}(:\d{2})?\b/g,placeholder:"{time}"}],exports.createLocaleManager=function(t){return t&&r.initializeFromServer(t),{getCurrentLocale:()=>r.getCurrentLocale(),setLocale:(t,e)=>r.setCurrentLocale(t,e),subscribe:t=>r.subscribe(t),navigateToLocalizedPath:(t,e)=>r.navigateToLocalizedPath(t,e),configurePathBasedRouting:(t,e)=>r.configurePathBasedRouting(t,e)}},exports.extractTemplate=function(t,e){let i=t;return e.forEach(({regex:t,placeholder:e})=>{i=i.replace(t,e)}),i},exports.interpolateText=function(t,e){return t.replace(/\{(\w+)\}/g,(t,i)=>{const s=e[i];return void 0!==s?String(s):t})};
